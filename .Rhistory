library(INLA)
library(INLABMA)
n = 100
set.seed(123)
x1 = runif(n)
x2 = runif(n)
err = rnorm(n)
y = 3 + 2*x1 -2*x2
df = data.frame(y = y, x1 = x1, x2 = x2)
save(file="databiv.Rdata",list=c("df"))
model = inla(y~1+x1+x2,data = df)
fit.inla <- function(data,b){
data$oset = b[1] * data$x1 +b[2]*data$x2
res = inla(y ~1+offset(oset), data = data)
return(list(mlik = res$mlik[1,1], model = res))
}
fit.inla(df, c(1,1))
dq.beta <- function(x, y, sigma = .75, log =TRUE) {
sum(dnorm(y, mean = x, sd = sigma, log = log))
}
rq.beta <- function(x, sigma = .75) {
rnorm(length(x), mean = x, sd = sigma)
}
prior.beta <- function(x, sigma = sqrt(1/.001), log = TRUE) {
sum(dnorm(x, mean = 0, sd= sigma, log = log))
}
inlamh.res <- INLAMH(df, fit.inla, c(0, 0), rq.beta, dq.beta, prior.beta,
n.sim = 10000, n.burnin = 500, n.thin = 10)
#Show results
b.sim <- do.call(rbind, inlamh.res$b.sim)
model.sim <- inlamh.res$model.sim
save(file = "INLA-MHbiv.RData", list = ls())
setwd("~/Documents/host2019/project/project-thesis")
save(file = "INLA-MHbiv.RData", list = ls())
View(inlamh.res)
View(inlamh.res)
View(model.sim)
save(file = "b.sim.Rdata", data = b.sim)
